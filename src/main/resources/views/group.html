<!DOCTYPE html>
<head>
    <meta charset="UTF-8">
    <title>group</title>

    <link rel="stylesheet" href="styles/dhtmlxgantt.css?v=7.0.11">

    <link rel="stylesheet" href="styles/codemirror.css">
    <link rel="stylesheet" href="styles/codemirror-neo.css">
    <link rel="stylesheet" href="styles/cy2neo.css">

    <link rel="stylesheet" href="styles/datatable.css">
    <link rel="stylesheet" href="styles/vendor.css"> <!-- bootstrap-->
    <link rel="stylesheet" href="styles/sweet-alert.css">
    <link rel="stylesheet" href="styles/gh-fork-ribbon.css">

    <!-- Basic Css files -->
    <link rel="stylesheet" href="styles/metismenu.min.css">
    <link rel="stylesheet" href="styles/neodCss1.css">

    <link rel="stylesheet" href="styles/morris.css">
    <link href="styles/metismenu.min.css" rel="stylesheet">
    <link href="styles/icons.css" rel="stylesheet">
    <link href="styles/style.css" rel="stylesheet" >
    <style>
        html, body {
            height: 100%;
            padding: 0px;
            margin: 0px;
            overflow: hidden;
        }

        .project-task .gantt_task_progress_drag,
        .phase-task .gantt_task_progress_drag {
            display: none !important;
        }

        /* hide 'plus' buttons for tasks */
        .regular-task .gantt_add {
            display: none;
        }
        .gantt_task_line.phase-task.gantt_bar_subproject{
            background-color: brown;
        }
        .huadong{
           /* width: 100px;
            height:45px;
            background: url("images/timg.jpg") no-repeat;*/
            border-style: none;
            position: absolute;
            margin-top: 26%;
            z-index: 100;
        }
        .huadong:hover{
            visibility: visible;
        }
        .list-group-item{
            height: 45px;
        }
        .gantt_task_line.project-task.gantt_project{
            display: none;
        }

    </style>
</head>

<body>
<div class = "huadong" id = "huadongId">
👉
</div>
<div id="relevantCase" style="text-align:center;margin:0 auto;position: absolute;width:514px" >
    <input class="form-control" type="text" style="width: 240px" id="keySelect" placeholder="关键字查询"/>

    <nav aria-label="Page navigation">
        <div id="pageData">
            <ul class="list-group" id="caseList">

            </ul>
        </div>
    </nav>
    <div class="page">
        <div id="page">

        </div>
    </div>
</div>
<div class="col-xl-9" style="width:514px;position:absolute;margin-top: 340px">
    <div class="card" style = "width:514px;height: 400px">
        <div class="card-body">
            <h4 class="mt-0 header-title mb-5">办案人处理案件排名</h4>
            <div id="morris-bar-stacked" class="morris-chart-height morris-charts"></div>
        </div>
    </div>
</div>
<div id="gantt_here" style='width:700px; height:700px;float:right;margin-right:0px'></div>
<script src="scripts/dhtmlxgantt.js?v=7.0.11"></script>
<script src="scripts/testdata.js?v=7.0.11"></script>
<script src="scripts/jquery.min.js"></script>

<script src="http://localhost:8083/hxyActiviti/scripts/jquery.min.js"></script>
<script src="http://localhost:8083/hxyActiviti/scripts/bootstrap.bundle.min.js"></script>
<script src="http://localhost:8083/hxyActiviti/scripts/modernizr.min.js"></script>
<script src="http://localhost:8083/hxyActiviti/scripts/metisMenu.min.js"></script>
<script src="http://localhost:8083/hxyActiviti/scripts/jquery.slimscroll.js"></script>
<script src="http://localhost:8083/hxyActiviti/scripts/waves.js"></script>
<script src="http://localhost:8083/hxyActiviti/scripts/jquery.peity.min.js"></script>
<script src="scripts/morris.min.js"></script>
<script src="http://localhost:8083/hxyActiviti/scripts/raphael-min.js"></script>
<script src="scripts/dashboard.js"></script>
<script src="http://localhost:8083/hxyActiviti/scripts/app.js"></script>
<script>
    /*gantt.message({
        text: "Predefined project structure with three levels of items<br>1 - <b>Projects</b><br>2 - <b>Subprojects</b><br>3 - <b>Tasks</b><br>Tasks can't have child items",
        expire: -1
    });*/

    gantt.config.open_tree_initially = true;
    gantt.config.scale_height = 50;

    gantt.config.scales = [
        {unit: "month", step: 1, format: "%F, %Y" },
        {unit: "day", step: 1, format: "%j"}
    ];
    gantt.config.types.root = "project-task";
    gantt.config.types.subproject = "subproject";
    gantt.config.lightbox.subproject_sections = gantt.config.lightbox.sections;
    gantt.config.lightbox.project_sections = [
        {name: "description", height: 70, map_to: "text", type: "textarea", focus: true},
        {name: "time", type: "duration", map_to: "auto", readonly: true}
    ];

    // set initial values based on task type
    function defaultValues(task) {
        var text = "",
            index = gantt.getChildren(task.parent || gantt.config.root_id).length + 1,
            types = gantt.config.types;

        switch (task.type) {
            case types.project:
                text = "姓名";
                break;
            case types.subproject:
                text = '案件';
                break;
            default:
                text = '操作';
                break;
        }
        task.text = text + " #" + index;
        return;
    }

    gantt.attachEvent("onTaskCreated", function (task) {
        var parent = task.parent,
            types = gantt.config.types,
            level = 0;

        if (parent == gantt.config.root_id || !parent) {
            level = 0;
        } else {
            level = gantt.getTask(task.parent).$level + 1;
        }
//assign task type based on task level
        switch (level) {
            case 0:
                task.type = types.project;
                break;
            case 1:
                task.type = types.subproject;
                break;
            default:
                task.type = types.task;
                break;
        }

        defaultValues(task);
        return true;
    });


    //css template for each task type
    gantt.templates.task_class = gantt.templates.grid_row_class = function (start, end, task) {
        switch (task.type) {
            case gantt.config.types.project:
                return 'project-task';
                break;
            case gantt.config.types.subproject:
                return 'phase-task';
                break;
            default:
                return 'regular-task';
                break;
        }
    };


    gantt.init("gantt_here");

    gantt.parse({
        data: [
            {id: 1426170055699, start_date: "02-01-2019 00:00", text: "姓名 :段鸿飞", duration: 9, type: "project", parent: 0},
            {id: 1426170055704, start_date: "03-01-2019 00:00", text: "案件 :杀人案件", duration: 8, parent: "1426170055699", type: "subproject"},
            {id: 1426170055707, start_date: "04-01-2019 00:00", text: "操作 :新建", duration: 1, parent: "1426170055704", type: "task"},
            {id: 1426170055710, start_date: "06-01-2019 00:00", text: "操作 :修改", duration: 1, parent: "1426170055704", type: "task"},
            {id: 1426170055711, start_date: "10-01-2019 00:00", text: "操作 :修改", duration: 1, parent: "1426170055704", type: "task"},
            {id: 1426170055712, start_date: "02-01-2019 00:00", text: "案件 :交通案件", duration: 6, parent: "1426170055699", type: "subproject"},
            {id: 1426170055715, start_date: "03-01-2019 00:00", text: "操作 :修改", duration: 1, parent: "1426170055712", type: "task", progress: 0},
            {id: 1426170055718, start_date: "07-01-2019 00:00", text: "操作 :修改", duration: 1, parent: "1426170055712", type: "task"},
            {id: 1426170055702, start_date: "02-01-2019 00:00", text: "姓名 :刘飞", duration: 1, type: "project", end_date: "17-01-2019 00:00", parent: 0},
            {id: 1426170055719, start_date: "02-01-2019 00:00", text: "案件 :杀人案件", duration: 11, parent: "1426170055702", type: "subproject"},
            {id: 1426170055722, start_date: "02-01-2019 00:00", text: "操作 :新建", duration: 1, parent: "1426170055719", type: "task"},
            {id: 1426170055725, start_date: "06-01-2019 00:00", text: "操作 :修改", duration: 1, parent: "1426170055719", type: "task"},
            {id: 1426170055726, start_date: "12-01-2019 00:00", text: "操作 :修改", duration: 1, parent: "1426170055719", type: "task"},
            {id: 1426170055703, start_date: "08-01-2019 00:00", text: "姓名 :张伟", duration: 1, type: "project", parent: 0},
            {id: 1426170055727, start_date: "08-01-2019 00:00", text: "案件 :交通案件", duration: 1, parent: "1426170055703", type: "subproject"}
        ], links: []
    });


</script>
<script>
over_flag = 0;
document.getElementById("huadongId").onclick = function() {
    gant = document.getElementById("gantt_here")
    if(over_flag == 0){
        gant.style.width = '100%';
        over_flag = 1;
    }
    else if(over_flag == 1){
        gant.style.width = "700px";
        gant.style.height = "700px";
        over_flag = 0;
    }
}
</script>
<script>
    function executeNode() {
        str = "<li class=\"list-group-item\" style=\"height: 45px;\"><span style=\"float: left;margin-top:-2px;text-align:left;\">" + "丁真" + "</span> "
            + "<button style=\"margin-left: 6px;float: right;margin-top:-6px\" type=\"button\" class=\"btn btn-primary\" onclick=\"lineageSelect1(\'" + "丁真" + "\')\">" + "绩效考核" + "</button> "
            + "<span style=\"float:right;margin-right:140px;margin-top:-2px\">" + "2000104" + "</span>";
        str += "<li class=\"list-group-item\" style=\"height: 45px;\"><span style=\"float: left;margin-top:-2px;text-align:left;\">" + "丁真" + "</span> "
            + "<button style=\"margin-left: 6px;float: right;margin-top:-6px\" type=\"button\" class=\"btn btn-primary\" onclick=\"lineageSelect1(\'" + "丁真" + "\')\">" + "绩效考核" + "</button> "
            + "<span style=\"float:right;margin-right:140px;margin-top:-2px\">" + "2000115" + "</span>";
        str += "<li class=\"list-group-item\" style=\"height: 45px;\"><span style=\"float: left;margin-top:-2px;text-align:left;\">" + "刘飞" + "</span> "
            + "<button style=\"margin-left: 6px;float: right;margin-top:-6px\" type=\"button\" class=\"btn btn-primary\" onclick=\"lineageSelect1(\'" + "刘飞" + "\')\">" + "绩效考核" + "</button> "
            + "<span style=\"float:right;margin-right:140px;margin-top:-2px\">" + "1900105" + "</span>";
        str += "<li class=\"list-group-item\" style=\"height: 45px;\"><span style=\"float: left;margin-top:-2px;text-align:left;\">" + "王煜" + "</span> "
            + "<button style=\"margin-left: 6px;float: right;margin-top:-6px\" type=\"button\" class=\"btn btn-primary\" onclick=\"lineageSelect1(\'" + "王煜" + "\')\">" + "绩效考核" + "</button> "
            + "<span style=\"float:right;margin-right:140px;margin-top:-2px\">" + "1900223" + "</span>";
        str += "<li class=\"list-group-item\" style=\"height:45px;\"><span style=\"float: left;margin-top:-2px;text-align:left;\">" + "张伟" + "</span> "
            + "<button style=\"margin-left: 6px;float: right;margin-top:-6px\" type=\"button\" class=\"btn btn-primary\" onclick=\"lineageSelect1(\'" + "张伟" + "\')\">" + "绩效考核" + "</button> "
            + "<span style=\"float:right;margin-right:140px;margin-top:-2px\">" + "1200448" + "</span>";
        str += "<li class=\"list-group-item\" style=\"height:45px;\"><span style=\"float: left;margin-top:-2px;text-align:left;\">" + "段鸿飞" + "</span> "
            + "<button style=\"margin-left: 6px;float: right;margin-top:-6px\" type=\"button\" class=\"btn btn-primary\" onclick=\"lineageSelect1(\'" + "段鸿飞" + "\')\">" + "绩效考核" + "</button> "
            + "<span style=\"float:right;margin-right:140px;margin-top:-2px\">" + "1700563" + "</span>";
        str += "<li class=\"list-group-item\" style=\"height:45px;\"><span style=\"float: left;margin-top:-2px;text-align:left;\">" + "贾南风" + "</span> "
            + "<button style=\"margin-left: 6px;float: right;margin-top:-6px\" type=\"button\" class=\"btn btn-primary\" onclick=\"lineageSelect1(\'" + "贾南风" + "\')\">" + "绩效考核" + "</button> "
            + "<span style=\"float:right;margin-right:140px;margin-top:-2px\">" + "1700567" + "</span>";
        str += "<li class=\"list-group-item\" style=\"height:45px;\"><span style=\"float: left;margin-top:-2px;text-align:left;\">" + "刘楠" + "</span> "
            + "<button style=\"margin-left: 6px;float: right;margin-top:-6px\" type=\"button\" class=\"btn btn-primary\" onclick=\"lineageSelect1(\'" + "刘楠" + "\')\">" + "绩效考核" + "</button> "
            + "<span style=\"float:right;margin-right:140px;margin-top:-2px\">" + "1800163" + "</span>";
        str += "<li class=\"list-group-item\" style=\"height:45px;\"><span style=\"float: left;margin-top:-2px;text-align:left;\">" + "段鸿飞" + "</span> "
            + "<button style=\"margin-left: 6px;float: right;margin-top:-6px\" type=\"button\" class=\"btn btn-primary\" onclick=\"lineageSelect1(\'" + "段鸿飞" + "\')\">" + "绩效考核" + "</button> "
            + "<span style=\"float:right;margin-right:140px;margin-top:-2px\">" + "1400732" + "</span>";
        document.getElementById("caseList").innerHTML += str;
        var zz = getzz();
        change(1, zz);
    }
    function getzz() {
        var a = $("ul#caseList li");
        var zz = new Array(a.length);
        for (var i = 0; i < a.length; i++) {
            zz[i] = a[i].innerHTML;
        } //div的字符串数组付给zz
        // console.log("zz is" + zz);
        return zz;
    }

    var pageno = 1;
    var gg;

    function change(e, zz) {
        //console.log("zz is" + zz);
        gg = zz;
        pageno = e;
        var pagesize = 6; //每页多少条信息
        if (zz.length % pagesize == 0) {
            var pageall = zz.length / pagesize;
        } else {
            var pageall = parseInt(zz.length / pagesize) + 1;
        }   //一共多少页
        if (e < 1) {
            e = 1;
            pageno = 1;//就等于第1页 ， 当前页为1
        }
        if (e > pageall) {  //如果输入页大于最大页
            e = pageall;
            pageno = pageall; //输入页和当前页都=最大页
        }
        $("#caseList").html("");//全部清空
        console.log("html is" + $("#caseList").html(""));
        var html = "";
        for (var i = 0; i < pagesize; i++) {
            if (zz[(e - 1) * pagesize + i] == null) zz[(e - 1) * pagesize + i] = "<span style=\"color:white\">空白</span>";
            html += '<li class=\"list-group-item\">' + zz[(e - 1) * pagesize + i] + '</li>';//创建一页的li列表
        }
        $("ul#caseList").html(html);//给ul列表写入html
        var ye = "";
        for (var j = 1; j <= pageall; j++) {
            if (e == j) {
                ye = ye + "<span><button onClick='change(" + j + ",gg)' style='color:#FF0000'>" + j + "</button></span> "
            } else {
                ye = ye + "<button onClick='change(" + j + ",gg)'>" + j + "</button> "
            }
        }
        var pageContent = "";
        pageContent += '第<span id=\"a2\">' + pageno + '</span>/';
        pageContent += '<span id="a1">' + pageall + '</span>页';
        pageContent += '<span id="a3">' + ye + '</span>';
        pageContent += '<button  onClick="change(--pageno,gg)">上一页</button>';
        pageContent += '<button onClick="change(++pageno,gg)">下一页</button>';
        $("#page").html(pageContent);
    }

    monitorClick();

    function monitorClick() {

        executeNode();
    }
</script>
<script>

    !function ($) {
        "use strict";

        var Dashboard = function () {
        };

        //creates Stacked chart
        Dashboard.prototype.createStackedChart  = function(element, data, xkey, ykeys, labels, lineColors) {
            Morris.Bar({
                element: element,
                data: data,
                xkey: xkey,
                ykeys: ykeys,
                stacked: true,
                labels: labels,
                hideHover: 'auto',
                resize: true, //defaulted to true
                gridLineColor: '#eeeeee',
                barColors: lineColors,
                labelTop:true,
                barRatio: 0.4,
                xLabelAngle: 35,
            });
        },
            // pie
            $('.peity-pie').each(function () {
                $(this).peity("pie", $(this).data());
            });

        //donut
        $('.peity-donut').each(function () {
            $(this).peity("donut", $(this).data());
        });

        // line
        $('.peity-line').each(function () {
            $(this).peity("line", $(this).data());
        });


        Dashboard.prototype.init = function () {
            var $stckedData  = [
                { y: '丁真', a: 300, b: 180, c: 100 },
                { y: '丁真', a: 205,  b: 65, c: 80 },
                { y: '刘飞', a: 170, b: 90, c: 56 },
                { y: '王煜', a: 75,  b: 85, c: 120 },
                { y: '张伟', a: 60, b: 90, c: 100 },
                { y: '段鸿飞', a: 75,  b: 65, c: 110 },
                { y: '贾南风', a: 60,  b: 50, c: 85 },
                { y: '刘楠', a: 55,  b: 65, c: 52 },
                { y: '段鸿飞', a: 50,  b: 40, c: 77 }
            ];
            this.createStackedChart('morris-bar-stacked', $stckedData, 'y', ['a', 'b', 'c'], ['案卡项数量', '环节个数', '环节耗时(平均/小时)'], ['#1699dd', '#655be6', '#ebeff2']);
        },
            //init
            $.Dashboard = new Dashboard, $.Dashboard.Constructor = Dashboard
    }(window.jQuery),

//initializing
        function ($) {
            "use strict";
            $.Dashboard.init();
        }(window.jQuery);

</script>
<script>
    function lineageSelect1(name_str){
        window.location.href="http://localhost:8083/hxyActiviti/neoBan.html?name="+encodeURI(name_str);
    }
</script>
</body>